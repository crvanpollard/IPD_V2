<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="initial-scale=1,user-scalable=no,maximum-scale=1,width=device-width">
  <meta name="description" content="">
  <meta name="author" content="">
  <title>DVRPC - Environmental Justice</title>
  <link href="https://netdna.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet" type="text/css">
  <link href="https://netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.min.css" rel="stylesheet" type="text/css">
  <link href="css/typeahead.js-bootstrap.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@0.7/dist/leaflet.css" />
  <link href="css/esri-leaflet-geocoder.css" rel="stylesheet" type="text/css">
  <link href="css/leaflet.draw.css" rel="stylesheet" type="text/css">
  <style type="text/css">
body {
margin-top: 52px;
position: absolute;
top:0;
bottom:0;
left: 0;
right: 0;
}
#map {
top:0;
right: 0;
bottom: 0;
left: 0;
position: absolute;
z-index:1;
transition: bottom 0.4s;
}
label {
font-weight: normal;
}
.panel-heading a:hover {
text-decoration: none;
}
#loading {
position: absolute;
width: 220px;
height: 19px;
top: 50%;
left: 50%;
margin: -10px 0 0 -110px;
z-index: 20001;
}
.navbar .navbar-brand {
font-weight: bold;
font-size: 22px;
color: white;
white-space: nowrap;
}
.navbar-inverse{
background-color:#0078AE;
border: none;
}
.navbar-inverse .navbar-nav > li > a {
color: white;
}
.typeahead {
background-color: #FFFFFF;
}
.tt-dropdown-menu {
background-color: #FFFFFF;
border: 1px solid rgba(0, 0, 0, 0.2);
border-radius: 4px 4px 4px 4px;
box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
margin-top: 4px;
padding: 4px 0;
width: 100%;
max-height: 300px;
overflow: auto;
}
.tt-suggestion {
font-size: 14px;
line-height: 20px;
padding: 3px 10px;
}
.tt-suggestion.tt-cursor {
background-color: #0097CF;
color: #FFFFFF;
cursor: pointer;
}
.tt-suggestion p {
margin: 0;
}
.tt-suggestion + .tt-suggestion {
border-top: 1px solid #ccc;
}
.typeahead-header {
margin: 0 5px 5px 5px;
padding: 3px 0;
border-bottom: 2px solid #333;
}
.has-feedback .form-control-feedback {
position: absolute;
top: 0;
right: 0;
display: block;
width: px;
height: 34px;
line-height: 34px;
text-align: center;
}
.modal-content {
    overflow: hidden;
}
.modal-header {
background-color:#0078ae;
}
.modal-title  {
color: white;
}
.close {
float: right;
font-size: 21px;
font-weight: bold;
line-height: 1;
color: white;
text-shadow: 0px 1px 0px rgb(255, 255, 255);
opacity: 1;
}
.panel-primary >.panel-heading {
background-color:#0078ae;
color: black;
}
.media{
padding: 0px 10px 0px 10px;
}
h3, .h3{
font-size: 16px;
font-weight: bold;
}
.btn-primary {
background-color: #66ABD1;
height:35px;
}
#toolbar{
background-color: #0078ae;
border-top: 2px solid white;
}
.leaflet-label {
background: rgb(235, 235, 235);
background: rgba(235, 235, 235, 0.81);
background-clip: padding-box;
border-color: #777;
border-color: rgba(0,0,0,0.25);
border-radius: 4px;
border-style: solid;
border-width: 4px;
color: #111;
display: block;
font: 12px/20px "Helvetica Neue", Arial, Helvetica, sans-serif;
font-weight: bold;
padding: 1px 6px;
position: absolute;
-webkit-user-select: none;
-moz-user-select: none;
-ms-user-select: none;
user-select: none;
white-space: nowrap;
z-index: 6;
}
.leaflet-label:before {
border-right: 6px solid black;
border-right-color: inherit;
border-top: 6px solid transparent;
border-bottom: 6px solid transparent;
content: "";
position: absolute;
top: 5px;
left: -10px;
}
.input-group{
width:200px;
}
.leaflet-control-zoom,.leaflet-control-layers {
border:none;
}
.pff_footer{
position:absolute;
bottom: 0;
background-color: white;
max-height: 200px;
z-index: 0;
overflow: hidden;
}
.pff_footer .close {
position: absolute;
right: 0;
top: 0;
color: #999;
padding: 3px;
}
#MapFooter {
overflow-y: auto;
height: 200px;
border-top: 2px solid #ddd;
margin-top: 24px;
}
.table-condensed thead>tr>th {
height: 0;
line-height: 0;
padding-top: 0;
padding-bottom: 0;
color: transparent;
border: none;
white-space: nowrap;
}
.pff_footer thead th div {
position: absolute;
padding: 5px;
line-height: 1;
z-index: 20;
vertical-align: bottom;
color: #333;
top: 0;
}
.searchico{
width:18px; height:18px;
margin-right:8px;
}
.btn-primary:hover{
background-color:#4583CE!important;
border-color: #2B5799!important;
}
.btn-default{
background-color:#0078ae;
border-color:#0078ae;
color:white;
}
.navbar-inverse .navbar-nav > .dropdown > a .caret {
border-top-color: white;
border-bottom-color: white;
}
#legendBox {
position: absolute;
top: 5px;
right:10px;
}
.img-legend {
height:30px;
width:30px
}
.leaflet-top-pane {
pointer-events: none;
}
#searchbox {
    width:200px;
}
#toggle {
    height: 34px; padding: 5px 10px; margin-right: 10px;
}
.navbar-brand img {
    max-height:40px;margin:-10px 10px -10px 0;
}
#aboutModal .modal-header img {
    margin:-2px 0 0;
}
#aboutTabsContent {
    padding-top: 10px;
}
#legendMap {
position: absolute;
bottom: 5px;
left: 10px;
z-index: 1001;
background-color: white;
padding: 8px;
border: 1px solid #444444;
background-repeat: no-repeat; 
}
.navbar-inverse .navbar-nav > li > a:hover {
    border: 1px solid #ddd;
    color: #D9D9D9;
}
        </style>
  <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.2/html5shiv.js" type="text/javascript"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/respond.js/1.2.0/respond.js" type="text/javascript"></script>
</head>
<body>
  <div class="navbar navbar-inverse navbar-fixed-top">
    <div class="navbar-header">
      <button id="toggle" type="button" class="navbar-toggle btn"> <i id="toggleIcon" class="glyphicon glyphicon-stats"></i>
      </button>
      <a class="navbar-brand" href="//www.dvrpc.org/" target="_blank">
        <img src="img/dvrpc_logo_small.png" alt="DVRPC">Indicators of Potential Disadvantage</a>
    </div>
	
    <div class="navbar-collapse collapse" id="navbar-collapse">
	
      <form class="navbar-form navbar-right">
        <div class="input-group search-container">
          <input id="searchbox" type="text" class="form-control" placeholder="Search data by MCD"></div>
      </form>
	  
      <ul class="nav navbar-nav navbar-right">
        <li>
         <a href="#" onclick="$('#aboutModal').modal('show'); return false;"><i class="icon-info-sign" ></i>&nbsp;&nbsp;About</a>
        </li>
         <li>
         <a href="#" onclick="$('#helpModal').modal('show'); return false;"><i class="icon-question-sign" ></i>&nbsp;&nbsp;Help</a>
        </li>
		
        <li class="dropdown">
          <a id="toolsDrop" href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="icon-list-alt"></i>&nbsp;Choose a Population Group</a>
          <ul class="dropdown-menu" >
            <li>
              <a href="#" onclick="$('#DODModal').modal('show'); return false;" data-value="IPD_SCORE" >
                <img class="img-legend" src="img/7.png" > Indicators of Potential Disadvantage (IPD)</a>
            </li>
            <li>
              <a href="#" onclick="$('#NHMModal').modal('show'); return false;" data-value="NONHISPCT">
                <img class="img-legend" src="img/9.png"> Non-Hispanic Minority (NHM)</a>
            </li>
                 <li>
              <a href="#" onclick="$('#HISModal').modal('show'); return false;" data-value="HISLATPCT" >
                <img class="img-legend" src="img/2.png" > Hispanic (HIS)</a>
            </li>
             <li>
              <a href="#" onclick="$('#POVModal').modal('show'); return false;" data-value="POVPCT">
                <img class="img-legend" src="img/6.png"> Households in Poverty (POV)</a>
            </li>
             <li>
              <a href="#" onclick="$('#LEPModal').modal('show'); return false;" data-value="LIMENGPCT" >
                <img class="img-legend" src="img/1.png" > Limited English Proficiency (LEP)</a>
            </li>
        <li>
              <a href="#" onclick="$('#FHHCModal').modal('show'); return false;" data-value="FEMHOHPCT" >
                <img class="img-legend" src="img/4.png"> Female Head of Household with Child (FHHC)</a>
            </li>
            <li>
              <a href="#" onclick="$('#ELD75Modal').modal('show'); return false;" data-value="ELDPCT" >
                <img class="img-legend" src="img/3.png" > Elderly (75 years and over) (ELD75)</a>
            </li>
        <li>
              <a href="#" onclick="$('#CHModal').modal('show'); return false;" data-value="CARLSSPCT" >
                <img class="img-legend" src="img/8.png" > Carless Households (CH)</a>
            </li>
			   <li>
              <a href="#" onclick="$('#DISModal').modal('show'); return false;" data-value="DISPCT" >
                <img class="img-legend" src="img/5.png" > Persons with Disabilities (PDIS)</a>
            </li>
           
          </ul>
        </li>
      </ul>
    </div>
  </div>
  
   <div class="col-xs-12" id="map"><div id="legendMap"> </div>

  </div> 
  
  <div class="navbar-fixed-bottom pff_footer">
    <button type="button" class="close" id="hideFooterBtn">&times;</button>
    <div id="MapFooter"></div>
  </div>
  
  <div class="modal fade" id="aboutModal">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <img src="img/Header.png">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
        </div>
        <div class="modal-body">
          <ul id="aboutTabs" class="nav nav-tabs">
            <li class="active">
              <a href="#about" role="tab" data-toggle="tab"><i class="icon-info-sign" style="color:#428BCA"></i>&nbsp;About the project</a>
            </li>
            <li>
              <a href="#purpose" role="tab" data-toggle="tab"><i class="icon-road" style="color:#428BCA"></i>&nbsp;Purpose</a>
            </li>
            <li>
              <a href="#contact" role="tab" data-toggle="tab"><i class="icon-envelope" style="color:#428BCA"></i>&nbsp;Contact</a>
            </li>
            <li>
              <a href="#disclaimer" role="tab" data-toggle="tab"><i class="icon-exclamation-sign" style="color:#428BCA"></i>&nbsp;Disclaimer</a>
            </li>
          </ul>
          <div id="aboutTabsContent" class="tab-content">
            <div class="tab-pane fade active in" id="about">
              <p>
                Title VI of the Civil Rights Act and the Executive Order on Environmental Justice (
                <a class="dialog_link" href="https://www.archives.gov/federal-register/executive-orders/pdf/12898.pdf" target="_blank">#12898</a>
                ) do not provide specific guidance to evaluate EJ issues within a region's transportation planning process. Therefore, MPOs must devise their own methods for ensuring that EJ issues are investigated and evaluated in transportation decision-making. In 2001, DVRPC developed an EJ technical assessment to identify direct and disparate impacts of its plans, programs, and planning processes on defined population groups in the Delaware Valley region. This assessment, the Indicators of Potential Disadvantage (IPD), is utilized in a variety of DVRPC plans and programs. DVRPC currently assesses the following population groups, defined by the
                <a href="https://www.census.gov/" target="_blank">U.S. Census Bureau:</a>
              </p>
              <ul style="font-size:90%">
                <li>Non-Hispanic Minority</li>
                <li>Carless Households</li>
                <li>Households in Poverty</li>
                <li>Female Head of Household with Child</li>
                <li>Elderly (75 years and over)</li>
                <li>Hispanic</li>
                <li>Limited English Proficiency</li>
				        <li>Persons with Disabilities</li>
              </ul>
              Using U.S. Census
              <a href="https://www.census.gov/acs/www/" target="_blank">American Community Survey (ACS)</a>
              2011-2015 five-year estimates data, the population groups listed above are identified and located at the census tract level.  Data is gathered at the regional level, combining populations from each of the nine counties, for either individuals or households, depending on the indicator. From there, the total number of persons in each demographic group is divided by the appropriate universe (either population or households) for the nine-county region, providing a regional average for that population group. Any census tract that meets or exceeds the regional average level, or threshold, is considered an EJ-sensitive tract for that group.
            </div>
            <div class="tab-pane fade" id="purpose">
              <p>
                This site is intended to be a resource for DVRPC staff and residents of the nine-county Greater Philadelphia region. As part of DVRPC's work in meeting Environmental Justice (EJ) and Title VI non-discrimination requirements, a methodology was created, and refined in subsequent years, to identify populations that may be adversely affected by transportation and regional planning decisions. Each population group identified may have specific planning-related challenges to address in DVRPC plans and programs.
                <br>
                <br>
                Title VI of the Civil Rights Act states that "no person in the United States, shall, on the grounds of race, color, or national origin be excluded from participation in, be denied the benefits of, or be subjected to discrimination under any program or activity receiving federal financial assistance. Environmental Justice is defined by the federal government as, "the fair treatment and meaningful involvement of all people regardless of race, color, national origin, or income with respect to the development, implementation, and enforcement of environmental laws, regulations, and policies."
                <br>
                <br>
                For additional information on DVRPC's EJ program and acitivities, visit:
                <br>
                <a href="//www.dvrpc.org/GetInvolved/TitleVI/" target="_blank">Title VI and Environmental Justice</a>
                <br><br>
                View the latest EJ publication:
                <br>
                <a href="//www.dvrpc.org/Products/TM15017" target="_blank">Environmental Justice at DVRPC - FY2014</a>
              </p>
            </div>
            <div class="tab-pane fade" id="contact">
              <p>
               Shoshana Akins
                <br>
                Public Participation Planner
                <br>
                Office of Communications and Engagement
                <br>
                Phone: 215-238-2817
                <br>
                <a href="mailto:sakins@dvrpc.org">sakins@dvrpc.org</a>
              </p>
            </div>
            <div class="tab-pane fade" id="disclaimer">
              <p>
                This web page is a public resource of general information. The Delaware Valley Regional Planning Commission (DVRPC) makes no warranty, representation, or guarantee as to the content, sequence, accuracy, timeliness, or completeness of any of the spatial data or database information provided herein. DVRPC and partner state, local, and other agencies shall assume no liability for errors, omissions, or inaccuracies in the information provided regardless of how caused; or any decision made or action taken or not taken by any person relying on any information or data furnished within.
              </p>
			  	  <p style="font-size:85%">
			  The Delaware Valley Regional Planning Commission (DVRPC) fully complies with Title VI of the Civil Rights Act of 1964, the Civil Rights Restoration Act of 1987, Executive Order 12898 on Environmental Justice, and related nondiscrimination statutes and regulations in all programs and activities. DVRPC' website, www.dvrpc.org, may be translated into multiple languages. Publications and other public documents can be made available in alternative languages and formats, if requested. DVRPC public meetings are always held in ADA-accessible facilities and in transit-accessible locations when possible. Auxiliary services can be provided to individuals who submit a request at least seven days prior to a meeting. Requests made within seven days will be accommodated to the greatest extent possible. Any person who believes they have been aggrieved by an unlawful discriminatory practice by DVRPC under Title VI has a right to file a formal complaint. Any such complaint may be in writing and filed with DVRPC's Title VI Compliance Manager and/or the appropriate state or federal agency within 180 days of the alleged discriminatory occurrence. For more information on DVRPC's Title VI program, or to obtain a Title VI Complaint Form, please call (215) 592-1800 or email public_affairs@dvrpc.org.
			  </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

    <div class="modal fade" id="helpModal">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title"><i class="icon-question-sign" ></i>&nbsp;&nbsp; Help</h4>
        </div>
        <div class="modal-body">
          <p>
         <b>Viewing Census Tract Information:</b><br>
         Click on the map to view census tract level information,including: IPD scores, population, household and IPD demographic percentages in a table below the map. <br><br>
         Use the "draw a polygon" <img src="img/poly.png" alt="** PLEASE DESCRIBE THIS IMAGE **"> or "draw a rectangle" <img src="img/rec.png" alt="** PLEASE DESCRIBE THIS IMAGE **"> from the tool bar to select a group of tracts; to remove the box simply click on the tool again.<br><br>

         Click the "Track" number for a detailed 2011-2015 ACS 5-year Estimate data profile provide by the U.S. Census Bureau for that census tract.
  
       </p>
       <p>
        <b> Abbreviation List:</b><br>
                <ul style="font-size:90%">
                <li>IPD = Indicators of Potential Disadvantage</li>
                <li>NHM = Non-Hispanic Minority</li>
                <li>CH = Carless Households</li>
                <li>POV = Households in Poverty</li>
                <li>FHHC = Female Head of Household with Child</li>
                <li>ELD75 = Elderly (75 years and over)</li>
                <li>HIS = Hispanic</li>
                <li>LEP = Limited English Proficiency</li>
                <li>PDIS = Persons with Disabilities</li>
                <li>Pop. = Total Population</li>
                <li>Pop.5yr = Total Population (over 5 years)</li>
                <li>HH = Total Households</li>
              </ul>
       </p>
        </div>
      </div>
    </div>
  </div>
  
  <div class="modal fade" id="DODModal">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title"><img class="img-legend" src="img/7.png"> Indicators of Potential Disadvantage (IPD)</h4>
        </div>
        <div class="modal-body">
          <p>
            DVRPC identifies eight demographic groups to make up the Indicators of Potential Disadvantage (IPD) analysis:
          </p>
          <ul>
            <li>Non-Hispanic Minority</li>
            <li>Carless Households</li>
            <li>Households in Poverty</li>
            <li>Persons with Disabilities</li>
            <li>Female Head of Household with Child</li>
            <li>Elderly (75 years and over)</li>
            <li>Hispanic</li>
            <li>Limited English Proficiency</li>
          </ul>
          Census tracts that have higher concentrations of a particular demographic group than the regional average for that population are considered to be at a disadvantage. 
		  The total number of demographic groups that are above the regional average concentration in each census tract is that tract's IPD. For example, if a tract has higher than average
		  populations for three of the identified demographic groups, then it has three (3) IPDs.
          <br>
          <img src="img/legend/dodflat.png" alt="** PLEASE DESCRIBE THIS IMAGE **"></div>
      </div>
    </div>
  </div>
  
  <div class="modal fade" id="NHMModal">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title"><img class="img-legend" src="img/9.png"> Non-Hispanic Minority</h4>
        </div>
        <div class="modal-body">
          <B>Regional Threshold: 28.36 percent</br>
          County Thresholds: 9.72 percent to 50.81 percent </b>
    <p>This population group includes the following ACS racial categories: Black or African American alone, American Indian and Alaska Native alone, Asian alone, Native  </p>
          <img src="img/legend/minority.png">
          <img src="img/legend/minority_bar.png">
        </div>

      </div>
    </div>
  </div>
  
  <div class="modal fade" id="CHModal">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">  <img class="img-legend" src="img/8.png"> Carless Households</h4>
        </div>
        <div class="modal-body">
         <B> Regional Threshold: 14.25 percent <br>
        County Thresholds: 4.33 percent to 32.09 percent</B>
    <p>This population is often referred to as "transit dependent," i.e., those who must rely on public transit for their daily travel needs and who may have limited mobility. It is recognized that not owning a personal automobile may be a lifestyle choice for some, but for others automobile ownership is unattainable due to various constraints, including income or disability.  
    </p>
          <img src="img/legend/carless.png" >
          <img src="img/legend/carless_bar.png"></div>
      </div>
    </div>
  </div>
  
  <div class="modal fade" id="POVModal">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title"><img class="img-legend" src="img/6.png"> Households in Poverty</h4>
        </div>
        <div class="modal-body">
         
        <B>Regional Threshold: 12.78 percent </br>
        County Thresholds: 6.25 percent to 24.32 percent</B>
    <p>Since poverty is defined at the family level and not the household level, the poverty status of the household is determined by the poverty status of the householder. Households are classified as poor when the total income of the householder's family is below the appropriate poverty threshold, which was established in the Office of Management and Budget's Statistical Policy Directive No. 14 and is adjusted for inflation. 
       
     </p>
          <img src="img/legend/poverty.png" >
          <img src="img/legend/poverty_bar.png"></div>
      </div>
    </div>
  </div>
  
  <div class="modal fade" id="FHHCModal">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title"><img class="img-legend" src="img/4.png"> Female Head of Household with Child</h4>
        </div>
        <div class="modal-body">
          <B> Regional Threshold: 8.69 percent</B><br>
          <B>County Thresholds: 5.01 percent to 13.12 percent</B>
    <p>This factor was chosen to add gender and children into the analysis, as well as to acknowledge the strong correlation between female heads of household with child and poverty status. In addition, this group may exhibit different travel patterns and needs than other population groups.  
    </p>
          <img src="img/legend/femalehoh.png" >
          <img src="img/legend/femalehoh_bar.png" ></div>
      </div>
    </div>
  </div>
  
  <div class="modal fade" id="ELD75Modal">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title"><img class="img-legend" src="img/3.png"> Elderly (75 years and over)</h4>
        </div>
        <div class="modal-body">
    <B>Regional Threshold: 6.55 percent<br>
    County Thresholds: 5.67 percent to 7.76 percent </B>
    <p>Mobility barriers and age are linked. Not every elderly individual has mobility challenges, but the likelihood of a challenge increases as an individual ages. Seniors aged 75 years qualify for most, if not all, mobility programs that have an age requirement.  
    </p>
          <img src="img/legend/elderly.png" >
          <img src="img/legend/elderly_bar.png"></div>
      </div>
    </div>
  </div>
  
  <div class="modal fade" id="HISModal">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title"><img class="img-legend" src="img/2.png">  Hispanic</h4>
        </div>
        <div class="modal-body">
    <B>Regional Threshold: 9.09 percent<br>
      County Thresholds: 3.40 percent to 16.24 percent </B>
      <p>Though often included in many minority definitions, Hispanic is an ethnicity, not a racial category. Hispanics are defined by the U.S. Census as "persons of Mexican, Puerto Rican, Cuban, Central or South American, or other Spanish culture or origin, regardless of race."
        </p>
          <img src="img/legend/hispanic.png" >
          <img src="img/legend/hispanic_bar.png"></div>
      </div>
    </div>
  </div>
  
  <div class="modal fade" id="LEPModal">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title"><img class="img-legend" src="img/1.png"> Limited English Proficiency</h4>
        </div>
        <div class="modal-body">
          <B> Regional Threshold: 3.44 percent <br>
        County Thresholds: 1.32 percent to 6.22 percent </B>
      <p>It is assumed that an inability to speak and understand English well can be a barrier to accessing goods and services, including transportation. In addition, identifying these populations and their locations is important to DVRPC's outreach efforts, particularly in assessing the need to make the agency's publications and written materials available in additional languages.
      </p>
          <img src="img/legend/engprof.png">
          <img src="img/legend/engprof_bar.png"></div>
      </div>
    </div>
    </div>
    
     <div class="modal fade" id="DISModal">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title"><img class="img-legend" src="img/5.png"> Persons with Disabilities (PDIS)</h4>
        </div>
        <div class="modal-body">
          <B> Regional Threshold: 12.14 percent <br>
              County Thresholds: 8.16 percent to 15.92 percent </B>
              <p>ACS uses several questions and data sources to try to capture six aspects of disability - hearing, vision, cognition, ambulation, difficulty bathing and dressing, and difficulty performing errands such as shopping - which can be used together to create an overall disability measure. Individuals with different ability levels have different travel patterns and needs. 
              </p>
          <img src="img/legend/disability.png">
          <img src="img/legend/disability_bar.png"></div>
      </div>
    </div>
  </div>
  
  <script type="text/javascript" src="https://code.jquery.com/jquery-1.11.0.min.js"></script>
  <script type="text/javascript" src="https://netdna.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="js/typeahead.bundle.min.js"></script>
  <script src="https://unpkg.com/leaflet@0.7/dist/leaflet.js"></script>
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/numeral.js/1.5.2/numeral.min.js"></script>
  <script src="js/leaflet.label.js" type="text/javascript"></script>
  <script src="js/leaflet.viewcenter.js" type="text/javascript"></script>
  <script src="js/esri-leaflet-geocoder.js" type="text/javascript"></script>
  <script src="js/leaflet.draw.js" type="text/javascript"></script>
  <script src="js/numeral.js" type="text/javascript"></script>
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/chroma-js/0.5.9/chroma.min.js"></script>
  
  <script type="text/javascript">
  //OPEN ABOUT DIALOG
 //  $('#aboutModal').modal();  

  
L.Marker.include({
  // override the 'getLayerId' function to return your ids rather then leaflets internal ids
  getLayerId: function (layer) {
    return layer.id;
  },
  getLayersById: function (arrayOfLayerIds) {
    var layers = [],
      i = arrayOfLayerIds.length - 1,
      id;
    // some logic to loop over layers and select them by id
    // leaflet maintains layers (markers) in an internal _layers property
    for (; i >= 0; i--) {
      id = arrayOfLayerIds[i];
      //jscs:disable disallowDanglingUnderscores
      layers.push(this._layers[id]);
      //jscs:enable disallowDanglingUnderscores
    }
    return layers;
  }
});

	$('#legendMap').appendTo('#map');
	
	$(document).ready(function() {
	loadImage()

  $('.dropdown-menu a').click(function() {
    if ($(this).data("value") == 'IPD_SCORE') {
      loadImage();}
    else {
      if ($(this).data("value") == 'NONHISPCT') {
      loadImageNH();
    }

	  else {
       if ($(this).data("value") == 'HISLATPCT') {
      loadImageHIS();
    }
    else {
       if ($(this).data("value") == 'POVPCT') {
      loadImagePOV();
    }
     else {
       if ($(this).data("value") == 'LIMENGPCT') {
      loadImageLEP();
    }
     else {
       if ($(this).data("value") == 'FEMHOHPCT') {
      loadImageFHHC();
    }
     else {
       if ($(this).data("value") == 'ELDPCT') {
      loadImageELD75();
    }
     else {
       if ($(this).data("value") == 'CARLSSPCT') {
      loadImageCH();
    }
     else {
       if ($(this).data("value") == 'DISPCT') {
      loadImagePDIS();
    }
 }
 }   
 }   
 }
 }
 }
 }  
 }
});


});	

function loadImage(){
  $('#legendMap').css('backgroundImage', 'url(img/legend/dod.png)');
 $('#legendMap').css('width', '210');
  $('#legendMap').css('height', '175');
}
function loadImageNH(){
  $('#legendMap').css('backgroundImage', 'url(img/legend/minority.png)');
  $('#legendMap').css('width', '255');
  $('#legendMap').css('height', '175');
}
function loadImageHIS(){
  $('#legendMap').css('backgroundImage', 'url(img/legend/hispanic.png)');
  $('#legendMap').css('width', '305');
  $('#legendMap').css('height', '175');
}
function loadImagePOV(){
  $('#legendMap').css('backgroundImage', 'url(img/legend/poverty.png)');
  $('#legendMap').css('width', '295');
  $('#legendMap').css('height', '175');
}
function loadImageLEP(){
  $('#legendMap').css('backgroundImage', 'url(img/legend/engprof.png)');
  $('#legendMap').css('width', '270');
  $('#legendMap').css('height', '175');
}
function loadImageFHHC(){
  $('#legendMap').css('backgroundImage', 'url(img/legend/femalehoh.png)');
  $('#legendMap').css('width', '300');
  $('#legendMap').css('height', '175');
}
function loadImageELD75(){
  $('#legendMap').css('backgroundImage', 'url(img/legend/elderly.png)');
  $('#legendMap').css('width', '270');
  $('#legendMap').css('height', '175');
}
function loadImageCH(){
  $('#legendMap').css('backgroundImage', 'url(img/legend/carless.png)');
  $('#legendMap').css('width', '295');
  $('#legendMap').css('height', '175');
}
function loadImagePDIS(){
  $('#legendMap').css('backgroundImage', 'url(img/legend/disability.png)');
  $('#legendMap').css('width', '278');
  $('#legendMap').css('height', '175');
}

var map,
  corridorSearch = [],
  getParameterByName = function (name) {
    var match = RegExp('[?&]' + name + '=([^&]*)').exec(window.location.search);
    return match ? decodeURIComponent(match[1].replace(/\+/g, ' ')) : null;
  },
  currentLayer = getParameterByName('l') || 'IPD_SCORE',
  
 

  getIMDColor = function (value) {
    layer = currentLayer || 'IPD_SCORE';
    var series = {
      IPD_SCORE: {
      breaks: [25,21,18,15,9],
      colors: ['#253494','#2c7fb8','#41b6c4','#a1dab4','#ffffcc']
     // colors: IPD_colors
      },
      NONHISPCT: {
        breaks: [0.7975, 0.5357, 0.2764, 0.1343],
        colors: ['#3E577C', '#5F608E', '#8087A3', '#D9D9D9']
      },
      HISLATPCT: {
        breaks: [0.4644, 0.238, 0.0833, 0.0456],
        colors: ['#18765D', '#52897C', '#789E95',  '#D9D9D9']
      },
       POVPCT: {
        breaks: [0.434, 0.2727, 0.1231, 0.0667],
        colors: ['#5C6453', '#78856C', '#B1BFA2',  '#D9D9D9']
      },
       LIMENGPCT: {
        breaks: [0.2144,0.1074, 0.032, 0.0186],
        colors: ['#347D85', '#71A8AF', '#B3E1E6',  '#D9D9D9']
      },  
      FEMHOHPCT: {
        breaks: [0.2565, 0.1658, 0.0887, 0.0446],
        colors: ['#C06928', '#E18D26', '#ECB576',  '#D9D9D9']
      },
      ELDPCT: {
        breaks: [0.3923, 0.17, 0.065, 0.0494],
        colors: ['#510808', '#7C3535', '#BA8C8C','#D9D9D9']
      },
      CARLSSPCT: {
        breaks: [0.5164,0.338,0.1467,0.0746],
        colors: ['#D2B729', '#DAC255', '#E2CF7F','#D9D9D9']
      },
	   DISPCT: {
        breaks: [0.4793,0.1923,0.1158,0.0797],
        breaks: [0.5672, 0.4254, 0.2836, 0.1417],
        colors: ['#3E577C', '#5F608E', '#8087A3', '#D9D9D9']
      },
      HISLATPCT: {
        breaks: [0.1819, 0.1364, 0.0909, 0.0454],
        colors: ['#18765D', '#52897C', '#789E95',  '#D9D9D9']
      },
       POVPCT: {
        breaks: [0.2558, 0.1918, 0.1278, 0.0638],
        colors: ['#5C6453', '#78856C', '#B1BFA2',  '#D9D9D9']
      },
       LIMENGPCT: {
        breaks: [0.0690, 0.0517, 0.0344, 0.0171],
        colors: ['#347D85', '#71A8AF', '#B3E1E6',  '#D9D9D9']
      },  
      FEMHOHPCT: {
        breaks: [0.1739, 0.1304, 0.0869, 0.0434],
        colors: ['#C06928', '#E18D26', '#ECB576',  '#D9D9D9']
      },
      ELDPCT: {
        breaks: [0.1311, 0.0983, 0.0655, 0.0327],
        colors: ['#510808', '#7C3535', '#BA8C8C','#D9D9D9']
      },
      CARLSSPCT: {
        breaks: [0.2851, 0.2138, 0.1425, 0.0712],
        colors: ['#D2B729', '#DAC255', '#E2CF7F','#D9D9D9']
      },
     DISPCT: {
        breaks: [0.2430, 0.1822, 0.1214, 0.0606],
        colors: ['#476C7A', '#86B5C6', '#B4CED9','#D9D9D9']
      }
     
    }, i;

    for (i = 0; i < series[layer].breaks.length; i++) {
      if (value > series[layer].breaks[i]) {
        return series[layer].colors[i];
      }
    }
    return '#FFFFFF';
  }, getIMDStyle = function (feature) {
    return {
      color: '#666',
      weight: 0.65,
      opacity: .8,
      fillOpacity: .75,
      fillColor: feature.properties ? getIMDColor(feature.properties[currentLayer]) : null
    }
  }, 
  EJDOD = L.geoJson(null, {
    style: getIMDStyle,
    onEachFeature: function (feature, layer) {
      feature.id = L.stamp(layer);
      if (feature.properties) {
        layer.bindLabel('Census Tract ' + feature.properties.NAME10);
        layer.on({
          click: layerClick,
          mouseover: hover,
          mouseout: resetHighlight
        });
        if (!$.grep(corridorSearch, function (e) { return e.name == feature.properties.MCD;}).length) {
          corridorSearch.push({
            name: feature.properties.MCD,
            source: 'DVRPC'
          });
        }
      }
    }
  }), 
  DVRPC = L.geoJson(null, {
    style: { color: 'black', weight: 4, fill: false, opacity: 0.75, clickable: false}
  }), 

  CartoDB_Positron = L.tileLayer('https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png', {
        maxZoom: 18, attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>, &copy; <a href="https://carto.com/attribution">CARTO</a>'
      });

  editableLayers = new L.FeatureGroup(),
  drawControl = new L.Control.Draw({
    position: 'topleft',
    draw: {
      rectangle:true,
      polygon: true,
      polyline:false,
      marker: false,
      circle:false
     // rectangle:true
    },
    edit: false
  }),
  viewCenter = new L.Control.ViewCenter(),
  searchControl = new L.esri.Controls.Geosearch(),
  results = L.layerGroup(),
  scaleControl = L.control.scale({
    position: 'bottomright'
  });

$.getJSON('data/IPD15.js', function (data) {
  EJDOD.addData(data);
});

$.getJSON('data/County_DVRPC.js', function (data) {
  DVRPC.addData(data);
  map.fitBounds(DVRPC.getBounds(), {reset: true});
});

map = L.map('map', {
  zoom: 9,
  center: new L.LatLng(39.97, -75.16),
  layers: [CartoDB_Positron, EJDOD, DVRPC, editableLayers]
});

//hack to resolve layerOrder add after layers added
EJDOD.once('mouseover', function (e) {
  DVRPC.bringToFront();
});

map.addControl(drawControl);
map.on('draw:drawstart', function () {
  editableLayers.clearLayers();
}).on('draw:created', function (e) {
  var type = e.layerType,
    layer = e.layer,
    results = L.layerGroup();
  editableLayers.addLayer(layer);
  editableLayers.eachLayer(function (layer) {
    EJDOD.eachLayer(function (ej) {
      if (layer.getBounds().intersects(ej.getBounds())) {
        results.addLayer(ej)
      }
    })
  })
  Info(results);
});

editableLayers.on('dblclick', function () {
  editableLayers.clearLayers();
});

function layerClick(e) {
  var results = L.layerGroup();
  results.addLayer(e.target);
  Info(results);
}

map.addControl(viewCenter);
map.addControl(searchControl);
map.addLayer(results);

searchControl.on('results', function (data) {
  results.clearLayers();
  for (var i = data.results.length - 1; i >= 0; i--) {
    results.addLayer(L.marker(data.results[i].latlng));
  };
}).on('error', function (e) {
  console.log(e);
});

$('#legendBox').appendTo('#map');

function Info(layers) {
  if (layers.getLayers().length === 0) {
    return;
  }
  var content = $('#EJTable-tmpl').html();
  layers.eachLayer(function (layer) {
    var props = layer.feature.properties

    content += '<tr data-layer="' + layer.feature.id + '"><th><a href="https://factfinder2.census.gov/bkmk/table/1.0/en/ACS/15_5YR/DP05/1400000US' + (props.GEOID10) + '" target="_blank">' + (props.NAME10) + '<\/a><\/th><td>' + numeral(props.POP15).format('0,0') + '<\/td><td>' + numeral(props.POP5YR15).format('0,0') + '<\/td><td>' + numeral(props.HH15).format('0,0') + '<\/td><td>' + (props.IPD_SCORE)+ '<\/td><td>' + (props.NONHISIPD) + ' <\/td><td>' + numeral(props.NONHISPCT).format('0.0 %')+ '<\/td><td>' + (props.HISLATIPD) + '<\/td><td>' + numeral(props.HiISLATPCT).format('0.0 %')+ '<\/td><td>' + (props.POVIPD) + '<\/td><td>' + numeral(props.POVPCT).format('0.0 %')+ '<\/td><td>' + (props.LIMENGIPD) + '<\/td><td>' + numeral(props.LIMENGPCT).format('0.0 %') + '<\/td><td>' + (props.FEMHOHIPD) + '<\/td><td>' + numeral(props.FEMHOHPCT).format('0.0 %')+ '<\/td><td>' + (props.ELDIPD) + '<\/td><td>' + numeral(props.ELDPCT).format('0.0 %')+ '<\/td><td>' + (props.CARLSSIPD) + '<\/td><td>' + numeral(props.CARLSSPCT).format('0.0 %')+ '<\/td>' + '<\/td><td>' + (props.DISIPD) + '<\/td><td>' + numeral(props.DISPCT).format('0.0 %')+ '<\/td><td>' + (props.CNTY) + '<\/td>' + '<\/td><td>' + (props.MCD) + '<\/td><\/tr>';
  });
  content += '<\/tbody><\/table>';
  $('#MapFooter').html(content);
  $('#map').css('bottom', $('#MapFooter').outerHeight())
  setTimeout(function () {map.invalidateSize(); }, 600);
};

function hover(e) {
  var layer = e.target;
  layer.setStyle({
    weight: 3,
    color: 'red',
    opacity:1
  });
  if (!L.Browser.ie && !L.Browser.opera) {
    layer.bringToFront();
  }
}

function resetHighlight(e) {
  //return layer to back of map
  if (!L.Browser.ie && !L.Browser.opera) {
    e.target.bringToBack();
  }
  EJDOD.resetStyle(e.target);
}

$(function () {
 // $('#legendBox select').on('change', function (e) {
    $('.dropdown-menu a').on('click', function (e) {
    currentLayer = $(this).data("value");
    if (currentLayer == 'none') {
      map.removeLayer(EJDOD);
    } else {
      if (!map.hasLayer(EJDOD)) {
        map.addLayer(EJDOD);
      } else {
        EJDOD.setStyle(getIMDStyle);
		L.DomEvent.preventDefault(e);
   //    e.preventDefault();
      }
    }
  });
  
  $('#MapFooter').on('mouseover', 'tbody tr', function () {
    hover({target: EJDOD.getLayer($(this).data('layer'))})
  }).on('mouseout', 'tbody tr', function () {
    resetHighlight({target: EJDOD.getLayer($(this).data('layer'))})
  });
  $('#hideFooterBtn').on('click', function () {
    $('#map').css('bottom', 0);
    setTimeout(function () {map.invalidateSize(); }, 600);
  });
 
 $('form').submit(function (e) {
    e.preventDefault();
  });
  
  // Typeahead search functionality
  $(document).one('ajaxStop', function () {
    $('#loading').hide();
    var corridorsBH = new Bloodhound({
      name: 'DVRPC',
      datumTokenizer: function (d) {
        return Bloodhound.tokenizers.whitespace(d.name);
      },
      queryTokenizer: Bloodhound.tokenizers.whitespace,
      local: corridorSearch,
      limit: 4
    }),
    geonamesBH = new Bloodhound({
      name: 'GeoNames',
      datumTokenizer: function (d) {
        return Bloodhound.tokenizers.whitespace(d.name);
      },
      queryTokenizer: Bloodhound.tokenizers.whitespace,
      remote: {
        url: 'https://api.geonames.org/searchJSON?username=bootleaf&featureClass=P&maxRows=5&countryCode=US&name_startsWith=%QUERY',
        filter: function (data) {
          return $.map(data.geonames, function (result) {
            return {
              name: result.name + ', ' + result.adminCode1,
              lat: result.lat,
              lng: result.lng,
              source: 'GeoNames'
            };
          });
        },
        ajax: {
          beforeSend: function (jqXhr, settings) {
            settings.url += '&east=' + map.getBounds().getEast() + '&west=' + map.getBounds().getWest() + '&north=' + map.getBounds().getNorth() + '&south=' + map.getBounds().getSouth();
            $('#searchicon').removeClass('fa-search').addClass('fa-refresh fa-spin');
          },
          complete: function (jqXHR, status) {
            $('#searchicon').removeClass('fa-refresh fa-spin').addClass('fa-search');
          }
        }
      },
      limit: 4
    });
    corridorsBH.initialize();
//    geonamesBH.initialize();
    // instantiate the typeahead UI
    $('#searchbox').typeahead({
      minLength: 3,
      highlight: true,
      hint: false
    }, {
      name: 'DVRPC',
      displayKey: 'name',
      source: corridorsBH.ttAdapter(),
      templates: {
        header: '<h4 class="typeahead-header">Municipality<\/h4>'
      }
    }, {
      name: 'GeoNames',
      displayKey: 'name',
      source: geonamesBH.ttAdapter(),
      templates: {
        header: '<h4 class="typeahead-header">Location<\/h4>'
      }
    }).on('typeahead:selected', function (obj, datum) {
      if (datum.source === 'DVRPC') {
        var results = L.featureGroup();
        EJDOD.eachLayer(function (ej) {
          if (ej.feature.properties.MCD_NAME === datum.name) {
            results.addLayer(ej);
          }
        });
        Info(results);
        map.fitBounds(results.getBounds());
      };
      if (datum.source === 'GeoNames') {
        map.setView([datum.lat, datum.lng], 14);
      };
      if ($('.navbar-collapse').height() > 50) {
        $('.navbar-collapse').collapse('hide');
      };
    }).on('typeahead:opened', function () {
      $('.navbar-collapse.in').css({'max-height': $(document).height() - $('.navbar-header').height(), height:  $(document).height() - $('.navbar-header').height()});
    }).on('typeahead:closed', function () {
      $('.navbar-collapse.in').css({'max-height': '', height: ''});
    });
    $('.twitter-typeahead').css({position: 'static', display: 'block'});
  });
  // Larger screens get scale control and expanded layer control
  if (document.body.clientWidth > 767) {
    map.addControl(scaleControl);
  }
  // Placeholder hack for IE
  if (navigator.appName == 'Microsoft Internet Explorer') {
    $('input').each(function () {
      if ($(this).val() == '' && $(this).attr('placeholder') != '') {
        $(this).val($(this).attr('placeholder'))
        .focus(function () {
          if ($(this).val() == $(this).attr('placeholder')) {
            $(this).val('');
          }
        })
        .blur(function () {
          if ($(this).val() == '') {
            $(this).val($(this).attr('placeholder'));
          }
        });
      }
    });
  }
});
</script>

  <script id="EJTable-tmpl" type="text/html">
<table id ="EJtable" class="table table-condensed table-striped table-hover">
<thead>
<tr>
<th class="hiconeven"> Tract <div>Tract</div></th>
<th class="hiconodd">Pop.<div>Pop.</div></th>
<th class="hiconeven">Pop.5yr<div>Pop.5yr</div></th>
<th class="hiconodd">HH<div>HH</div></th>
<th class="hiconeven">IPD<div>IPD</div></th>
<th class="hiconodd">NHM<div>NHM</div></th>
<th class="hiconeven">NHM %<div>NHM %</div></th>
<th class="hiconodd">HIS<div>HIS</div></th>
<th class="hiconeven">HIS %<div>HIS %</div></th>
<th class="hiconodd">POV<div>POV</div></th>
<th class="hiconeven">POV %<div>POV %</div></th>
<th class="hiconodd">LEP<div>LEP</div></th>
<th class="hiconeven">LEP %<div>LEP %</div></th>
<th class="hiconodd">FHHC<div>FHHC</div></th>
<th class="hiconeven">FHHC %<div>FHHC %</div></th>
<th class="hiconodd">ELD75<div>ELD75</div></th>
<th class="hiconeven">ELD75 %<div>ELD75 %</div></th>
<th class="hiconodd">CH<div>CH</div></th>
<th class="hiconeven">CH%<div>CH%</div></th>
<th class="hiconodd">PDIS<div>PDIS</div></th>
<th class="hiconeven">PDIS%<div>PDIS%</div></th>
<th class="hiconodd">County<div>County</div></th>
<th class="hiconeven">Municipality<div>Municipality</div></th>
</tr>
</thead>
</tbody>
</script>

 <script>var _gaq=[['_setAccount','UA-9825778-1'],['_trackPageview']];(function(d){var g=d.createElement('script'),s=d.scripts[0];g.src='//www.google-analytics.com/ga.js';s.parentNode.insertBefore(g,s)}(document))</script>
 
</body>
</html>